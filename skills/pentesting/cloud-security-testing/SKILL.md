---
name: cloud-security-testing
description: |
  Cloud security assessment for AWS, Azure, and GCP environments. Test IAM,
  storage, compute, and network security in cloud platforms.
  Use for authorized cloud penetration testing.
license: Apache-2.0
compatibility: |
  - Python 3.9+
  - Optional: boto3, azure-sdk, google-cloud
metadata:
  author: SherifEldeeb
  version: "1.0.0"
  category: pentesting
---

# Cloud Security Testing Skill

Cloud security testing capabilities for AWS, Azure, and GCP.

## Capabilities

- **IAM Analysis**: Users, roles, policies, permissions
- **Storage Security**: S3, Blob, GCS bucket security
- **Compute Security**: EC2, VMs, serverless security
- **Network Security**: VPC, security groups, firewall rules
- **Secrets Management**: Key vaults, secrets exposure
- **Privilege Escalation**: Cloud-specific privesc paths
- **Persistence**: Cloud persistence techniques

## Quick Start

```python
from cloud_utils import AWSAssessor, AzureAssessor, GCPAssessor

# AWS assessment
aws = AWSAssessor(access_key='...', secret_key='...')
findings = aws.run_assessment()

# Azure assessment
azure = AzureAssessor(tenant_id='...', client_id='...')
findings = azure.run_assessment()
```

## Usage

### AWS Security Assessment

Assess AWS environment security.

**Example**:
```python
from cloud_utils import AWSAssessor

aws = AWSAssessor(
    access_key='AKIA...',
    secret_key='...',
    region='us-east-1'
)

# IAM Analysis
iam = aws.analyze_iam()
print(f"Users: {len(iam['users'])}")
print(f"Roles: {len(iam['roles'])}")
print(f"Admin users: {iam['admin_users']}")
print(f"Overprivileged: {iam['overprivileged']}")

# S3 bucket security
s3 = aws.analyze_s3()
for bucket in s3['public_buckets']:
    print(f"Public bucket: {bucket['name']}")
for bucket in s3['unencrypted']:
    print(f"Unencrypted: {bucket['name']}")

# EC2 security
ec2 = aws.analyze_ec2()
print(f"Public instances: {ec2['public_instances']}")
print(f"IMDSv1 enabled: {ec2['imdsv1_enabled']}")

# Security groups
sgs = aws.analyze_security_groups()
for sg in sgs['overly_permissive']:
    print(f"Overly permissive: {sg['id']} - {sg['issue']}")

# Secrets exposure
secrets = aws.find_exposed_secrets()

# Privilege escalation paths
privesc = aws.find_privesc_paths()
for path in privesc:
    print(f"Path: {path['technique']}")

# Run full assessment
findings = aws.run_assessment()
aws.export_report('aws_assessment.json')
```

### Azure Security Assessment

Assess Azure environment security.

**Example**:
```python
from cloud_utils import AzureAssessor

azure = AzureAssessor(
    tenant_id='...',
    client_id='...',
    client_secret='...'
)

# Entra ID (Azure AD) Analysis
entra = azure.analyze_entra_id()
print(f"Users: {len(entra['users'])}")
print(f"Global Admins: {entra['global_admins']}")
print(f"Guest users: {entra['guests']}")
print(f"MFA disabled: {entra['mfa_disabled']}")

# Blob storage
storage = azure.analyze_storage()
for container in storage['public_containers']:
    print(f"Public: {container}")

# Virtual machines
vms = azure.analyze_vms()

# Key Vault
keyvault = azure.analyze_key_vault()

# Network security groups
nsgs = azure.analyze_nsgs()

# Privilege escalation
privesc = azure.find_privesc_paths()

# Full assessment
findings = azure.run_assessment()
```

### GCP Security Assessment

Assess GCP environment security.

**Example**:
```python
from cloud_utils import GCPAssessor

gcp = GCPAssessor(
    credentials_file='service-account.json',
    project='my-project'
)

# IAM analysis
iam = gcp.analyze_iam()
print(f"Primitive roles: {iam['primitive_roles']}")
print(f"Owner accounts: {iam['owners']}")

# GCS bucket security
gcs = gcp.analyze_gcs()
for bucket in gcs['public_buckets']:
    print(f"Public: {bucket}")

# Compute instances
compute = gcp.analyze_compute()

# Firewall rules
firewall = gcp.analyze_firewall()

# Service accounts
sa = gcp.analyze_service_accounts()
print(f"Key exposed: {sa['exposed_keys']}")

# Full assessment
findings = gcp.run_assessment()
```

### Cross-Cloud Analysis

Analyze multi-cloud environments.

**Example**:
```python
from cloud_utils import MultiCloudAssessor

multi = MultiCloudAssessor()
multi.add_aws(aws_assessor)
multi.add_azure(azure_assessor)
multi.add_gcp(gcp_assessor)

# Cross-cloud findings
findings = multi.analyze()
print(f"Total findings: {len(findings)}")
print(f"Critical: {findings['critical']}")

# Generate report
multi.generate_report('multi_cloud_report.pdf')
```

## Configuration

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `AWS_ACCESS_KEY_ID` | AWS access key | No | None |
| `AZURE_TENANT_ID` | Azure tenant ID | No | None |
| `GOOGLE_APPLICATION_CREDENTIALS` | GCP credentials | No | None |

## Limitations

- **Permissions**: Requires appropriate cloud credentials
- **API Limits**: May hit rate limits on large environments
- **Coverage**: Not all services covered

## Related Skills

- [reconnaissance](../reconnaissance/): Cloud asset discovery
- [api-security-testing](../api-security-testing/): Cloud API testing
- [pentest-reporting](../pentest-reporting/): Document findings

## References

- [AWS Security Best Practices](https://docs.aws.amazon.com/security/)
- [Azure Security Benchmark](https://docs.microsoft.com/security/benchmark/azure/)
- [GCP Security Best Practices](https://cloud.google.com/security/best-practices)
