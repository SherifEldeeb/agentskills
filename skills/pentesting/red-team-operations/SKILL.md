---
name: red-team-operations
description: |
  Red team operation planning and execution. Adversary simulation, C2 operations,
  objective tracking, and operational security for authorized engagements.
  Use for red team assessments.
license: Apache-2.0
compatibility: |
  - Python 3.9+
metadata:
  author: SherifEldeeb
  version: "1.0.0"
  category: pentesting
---

# Red Team Operations Skill

Red team operation management and adversary simulation capabilities.

## Capabilities

- **Operation Planning**: Mission planning, scope, objectives
- **Adversary Emulation**: Threat actor simulation, TTPs
- **C2 Operations**: Command and control management
- **Objective Tracking**: Flag tracking, mission objectives
- **Operational Security**: OPSEC considerations
- **Collaboration**: Team coordination
- **Debrief**: Post-operation analysis

## Quick Start

```python
from redteam_utils import RedTeamOp, AdversaryProfile, C2Manager

# Plan operation
op = RedTeamOp('Operation Sunset')
op.set_objectives(['domain_admin', 'data_exfil'])
op.set_timeline('2024-01-15', '2024-01-30')

# Adversary emulation
adversary = AdversaryProfile('APT29')
ttps = adversary.get_ttps()

# C2 management
c2 = C2Manager()
c2.add_implant('beacon1', '192.168.1.100')
```

## Usage

### Operation Planning

Plan and manage red team operations.

**Example**:
```python
from redteam_utils import RedTeamOp

op = RedTeamOp('Operation Sunset')

# Set operation details
op.set_client('Acme Corporation')
op.set_scope({
    'in_scope': ['10.0.0.0/8', '*.acme.com'],
    'out_of_scope': ['hr.acme.com', 'production-db'],
    'restrictions': ['No DoS', 'No destructive actions']
})

# Set objectives
op.add_objective(
    name='Domain Admin',
    description='Obtain Domain Admin credentials',
    priority='high',
    points=100
)

op.add_objective(
    name='Data Exfiltration',
    description='Exfiltrate sensitive data from file server',
    priority='high',
    points=150
)

op.add_objective(
    name='Physical Access',
    description='Gain physical access to server room',
    priority='medium',
    points=75
)

# Set timeline
op.set_timeline('2024-01-15', '2024-01-30')
op.add_phase('Reconnaissance', '2024-01-15', '2024-01-18')
op.add_phase('Initial Access', '2024-01-18', '2024-01-22')
op.add_phase('Post-Exploitation', '2024-01-22', '2024-01-28')
op.add_phase('Exfiltration', '2024-01-28', '2024-01-30')

# Rules of engagement
op.set_roe({
    'working_hours': '09:00-17:00',
    'emergency_contact': 'security@acme.com',
    'deconfliction': 'Check with SOC before any action'
})

# Export operation plan
op.export_plan('operation_plan.json')
```

### Adversary Emulation

Emulate specific threat actors.

**Example**:
```python
from redteam_utils import AdversaryProfile

# Load adversary profile
adversary = AdversaryProfile('APT29')

# Get TTPs
ttps = adversary.get_ttps()
print(f"Initial Access: {ttps['initial_access']}")
print(f"Execution: {ttps['execution']}")
print(f"Persistence: {ttps['persistence']}")
print(f"C2: {ttps['command_and_control']}")

# Get tools
tools = adversary.get_tools()
print(f"Tools: {tools}")

# Get IOCs to emulate
iocs = adversary.get_iocs()

# Generate attack plan based on TTPs
attack_plan = adversary.generate_attack_plan()
for phase in attack_plan:
    print(f"Phase: {phase['name']}")
    for technique in phase['techniques']:
        print(f"  - {technique['id']}: {technique['name']}")

# Map to MITRE ATT&CK
mapping = adversary.get_attack_mapping()
```

### C2 Operations

Manage command and control infrastructure.

**Example**:
```python
from redteam_utils import C2Manager

c2 = C2Manager()

# Add infrastructure
c2.add_redirector('redir1', '1.2.3.4', 'Azure')
c2.add_teamserver('ts1', '10.0.0.10', 'Cobalt Strike')

# Track implants
c2.add_implant(
    name='beacon1',
    host='192.168.1.100',
    user='jsmith',
    implant_type='beacon',
    callback_time=60
)

# Log commands
c2.log_command('beacon1', 'shell whoami', 'ACME\\jsmith')
c2.log_command('beacon1', 'hashdump', '[hashes]')

# Track sessions
sessions = c2.list_sessions()
for s in sessions:
    print(f"{s['name']}: {s['host']} ({s['user']})")

# Infrastructure rotation
c2.rotate_infrastructure('redir1')

# Export IOCs for deconfliction
c2.export_iocs('iocs.json')
```

### Objective Tracking

Track mission objectives and flags.

**Example**:
```python
from redteam_utils import ObjectiveTracker

tracker = ObjectiveTracker('Operation Sunset')

# Mark objectives
tracker.mark_complete(
    objective='Domain Admin',
    evidence='screenshots/da_proof.png',
    timestamp='2024-01-25 14:30:00',
    operator='operator1'
)

# Add flags
tracker.add_flag(
    name='CEO Mailbox',
    value='FLAG{c30_m41lb0x_4cc3ss}',
    location='Exchange Server',
    points=50
)

# Get progress
progress = tracker.get_progress()
print(f"Completed: {progress['completed']}/{progress['total']}")
print(f"Points: {progress['points']}/{progress['max_points']}")

# Timeline
timeline = tracker.get_timeline()
for event in timeline:
    print(f"{event['time']}: {event['action']}")
```

### Operational Security

Maintain OPSEC during operations.

**Example**:
```python
from redteam_utils import OPSEC

opsec = OPSEC()

# Check OPSEC considerations
checklist = opsec.get_checklist()
for item in checklist:
    print(f"[ ] {item}")

# Log OPSEC events
opsec.log_event(
    event='C2 callback detected',
    risk='medium',
    mitigation='Switched to backup channel'
)

# Check infrastructure
infra_check = opsec.check_infrastructure([
    '1.2.3.4',
    'c2.example.com'
])

# Sanitize data before exfil
sanitized = opsec.sanitize_data(data)

# Generate OPSEC report
report = opsec.generate_report()
```

## Configuration

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `REDTEAM_OP_DIR` | Operation directory | No | `./ops` |
| `C2_LOG_PATH` | C2 log path | No | `./logs` |

## Limitations

- **Authorization**: Requires explicit written authorization
- **Legal**: Must comply with all applicable laws
- **Scope**: Stay within defined scope

## Related Skills

- [reconnaissance](../reconnaissance/): Target research
- [exploitation](../exploitation/): Attack execution
- [post-exploitation](../post-exploitation/): Post-access activities
- [pentest-reporting](../pentest-reporting/): Operation reporting

## References

- [MITRE ATT&CK](https://attack.mitre.org/)
- [Red Team Development and Operations](https://redteam.guide/)
