---
name: wireless-security
description: |
  Wireless network security testing including WiFi, Bluetooth, and RF analysis.
  Test WPA/WPA2/WPA3, rogue access points, and wireless attack techniques.
  Use for wireless security assessments.
license: Apache-2.0
compatibility: |
  - Python 3.9+
  - Optional: scapy, aircrack-ng integration
metadata:
  author: SherifEldeeb
  version: "1.0.0"
  category: pentesting
---

# Wireless Security Skill

Wireless network security testing capabilities for authorized assessments.

## Capabilities

- **WiFi Reconnaissance**: Discover and analyze wireless networks
- **WPA/WPA2 Attacks**: Capture handshakes, crack passwords
- **Rogue AP Detection**: Identify unauthorized access points
- **Evil Twin Attacks**: Create rogue access points
- **Client Attacks**: Target wireless clients
- **Bluetooth Testing**: Bluetooth security assessment
- **RF Analysis**: Radio frequency analysis

## Quick Start

```python
from wireless_utils import WiFiScanner, WPACracker, EvilTwin

# Scan for networks
scanner = WiFiScanner('wlan0')
networks = scanner.scan()

# Capture handshake
cracker = WPACracker()
cracker.capture_handshake('TargetNetwork', 'wlan0')
cracker.crack('rockyou.txt')

# Evil twin
evil = EvilTwin('wlan0')
evil.create_ap('FreeWiFi')
```

## Usage

### WiFi Reconnaissance

Discover and analyze wireless networks.

**Example**:
```python
from wireless_utils import WiFiScanner

scanner = WiFiScanner('wlan0')

# Scan for networks
networks = scanner.scan()
for net in networks:
    print(f"SSID: {net['ssid']}")
    print(f"  BSSID: {net['bssid']}")
    print(f"  Channel: {net['channel']}")
    print(f"  Security: {net['security']}")
    print(f"  Signal: {net['signal']} dBm")

# Detailed scan
detailed = scanner.detailed_scan('TargetNetwork')
print(f"Clients: {detailed['clients']}")
print(f"WPS: {detailed['wps_enabled']}")
print(f"WPS locked: {detailed['wps_locked']}")

# Monitor specific network
scanner.monitor_network('00:11:22:33:44:55', duration=300)

# Export results
scanner.export_results('wifi_scan.json')
```

### WPA/WPA2 Attacks

Attack WPA/WPA2 protected networks.

**Example**:
```python
from wireless_utils import WPACracker

cracker = WPACracker()

# Capture handshake
cracker.capture_handshake(
    ssid='TargetNetwork',
    interface='wlan0',
    timeout=300
)

# Or deauth to force reconnection
cracker.deauth_capture(
    bssid='00:11:22:33:44:55',
    client='66:77:88:99:AA:BB',
    interface='wlan0'
)

# Crack with dictionary
result = cracker.crack('rockyou.txt')
if result['success']:
    print(f"Password: {result['password']}")

# Crack with hashcat
result = cracker.crack_hashcat(
    wordlist='rockyou.txt',
    rules='best64.rule'
)

# PMKID attack (clientless)
cracker.pmkid_capture('wlan0')
cracker.crack_pmkid('rockyou.txt')

# Export for offline cracking
cracker.export_hccapx('handshake.hccapx')
cracker.export_22000('handshake.22000')
```

### Rogue AP Detection

Detect unauthorized access points.

**Example**:
```python
from wireless_utils import RogueAPDetector

detector = RogueAPDetector('wlan0')

# Load authorized APs
detector.load_authorized_aps('authorized_aps.json')

# Continuous monitoring
detector.start_monitoring(alert_callback=handle_alert)

# Single scan
rogues = detector.detect_rogue_aps()
for ap in rogues:
    print(f"Rogue AP: {ap['ssid']} ({ap['bssid']})")
    print(f"  Reason: {ap['reason']}")

# Detect evil twins
twins = detector.detect_evil_twins()

# Generate report
report = detector.generate_report()
```

### Evil Twin Attacks

Create rogue access points.

**Example**:
```python
from wireless_utils import EvilTwin

evil = EvilTwin('wlan0')

# Create basic evil twin
evil.create_ap(
    ssid='FreeWiFi',
    channel=6
)

# Clone existing network
evil.clone_ap('TargetNetwork', '00:11:22:33:44:55')

# Start captive portal
evil.start_captive_portal(
    template='login',
    capture_creds=True
)

# Capture traffic
evil.start_traffic_capture('capture.pcap')

# Get captured credentials
creds = evil.get_captured_creds()
for cred in creds:
    print(f"{cred['username']}:{cred['password']}")

# Stop and cleanup
evil.stop()
```

### Client Attacks

Target wireless clients.

**Example**:
```python
from wireless_utils import ClientAttacker

attacker = ClientAttacker('wlan0')

# Deauthentication attack
attacker.deauth(
    bssid='00:11:22:33:44:55',
    client='66:77:88:99:AA:BB',
    count=10
)

# Broadcast deauth
attacker.deauth_all('00:11:22:33:44:55')

# Probe request capture
probes = attacker.capture_probes(duration=300)
for client, ssids in probes.items():
    print(f"Client {client} looking for: {ssids}")

# Karma attack
attacker.karma_attack()
```

### Bluetooth Testing

Bluetooth security assessment.

**Example**:
```python
from wireless_utils import BluetoothScanner

bt = BluetoothScanner('hci0')

# Discover devices
devices = bt.discover(duration=30)
for dev in devices:
    print(f"Device: {dev['name']} ({dev['address']})")
    print(f"  Class: {dev['class']}")
    print(f"  Services: {dev['services']}")

# BLE scanning
ble_devices = bt.discover_ble(duration=30)

# Service enumeration
services = bt.enumerate_services('00:11:22:33:44:55')

# Check for vulnerabilities
vulns = bt.check_vulnerabilities('00:11:22:33:44:55')
```

## Configuration

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `WIRELESS_INTERFACE` | Default wireless interface | No | `wlan0` |
| `MONITOR_INTERFACE` | Monitor mode interface | No | `wlan0mon` |

## Limitations

- **Hardware Required**: Requires compatible wireless adapter
- **Monitor Mode**: Many attacks require monitor mode support
- **Legal**: Wireless attacks require explicit authorization

## Related Skills

- [reconnaissance](../reconnaissance/): Network discovery
- [password-attacks](../password-attacks/): Crack captured hashes
- [pentest-reporting](../pentest-reporting/): Document findings

## References

- [Aircrack-ng Documentation](https://www.aircrack-ng.org/documentation.html)
- [WiFi Alliance](https://www.wi-fi.org/)
