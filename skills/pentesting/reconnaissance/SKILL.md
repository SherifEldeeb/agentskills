---
name: reconnaissance
description: |
  Open Source Intelligence (OSINT) and reconnaissance techniques for information
  gathering during penetration testing engagements. Passive and active reconnaissance.
  Use for initial target assessment and attack surface mapping.
license: Apache-2.0
compatibility: |
  - Python 3.9+
  - Optional: requests, dnspython, whois
metadata:
  author: SherifEldeeb
  version: "1.0.0"
  category: pentesting
---

# Reconnaissance Skill

Comprehensive OSINT and reconnaissance capabilities for information gathering during authorized penetration testing engagements.

## Capabilities

- **Passive Reconnaissance**: Gather information without direct target interaction
- **Active Reconnaissance**: Probe targets for detailed information
- **Domain Intelligence**: DNS enumeration, WHOIS, subdomain discovery
- **Email Harvesting**: Discover email addresses and patterns
- **Technology Fingerprinting**: Identify technologies and frameworks
- **Social Media OSINT**: Gather intelligence from social platforms
- **Document Metadata**: Extract metadata from public documents
- **Attack Surface Mapping**: Visualize and document attack surface

## Quick Start

```python
from recon_utils import PassiveRecon, DomainIntel, AttackSurfaceMapper

# Passive reconnaissance
recon = PassiveRecon('target.com')
recon.gather_dns_info()
recon.discover_subdomains()
print(recon.generate_report())

# Domain intelligence
domain = DomainIntel('target.com')
domain.enumerate_dns_records()
domain.whois_lookup()
print(domain.get_summary())

# Map attack surface
mapper = AttackSurfaceMapper('Target Corp')
mapper.add_domain('target.com')
mapper.add_ip_range('10.0.0.0/24')
print(mapper.generate_map())
```

## Usage

### Passive Reconnaissance

Gather information without directly interacting with target systems.

**Example**:
```python
from recon_utils import PassiveRecon

recon = PassiveRecon('target.com')

# DNS information gathering
recon.gather_dns_info()

# Subdomain discovery via passive sources
recon.discover_subdomains()

# Email pattern discovery
recon.discover_email_patterns()

# Technology identification
recon.identify_technologies()

# Search for exposed documents
recon.search_documents()

# Generate comprehensive report
report = recon.generate_report()
print(report)
```

### Domain Intelligence

Deep dive into domain-related information.

**Example**:
```python
from recon_utils import DomainIntel

domain = DomainIntel('target.com')

# Enumerate all DNS record types
domain.enumerate_dns_records()
print(f"A Records: {domain.records['A']}")
print(f"MX Records: {domain.records['MX']}")
print(f"TXT Records: {domain.records['TXT']}")
print(f"NS Records: {domain.records['NS']}")

# WHOIS lookup
whois_info = domain.whois_lookup()
print(f"Registrar: {whois_info['registrar']}")
print(f"Created: {whois_info['creation_date']}")

# Zone transfer attempt (authorized testing only)
domain.attempt_zone_transfer()

# Find related domains
domain.find_related_domains()

# Check for SPF, DKIM, DMARC
domain.check_email_security()

# Generate summary
print(domain.get_summary())
```

### Subdomain Enumeration

Discover subdomains through various techniques.

**Example**:
```python
from recon_utils import SubdomainEnumerator

enum = SubdomainEnumerator('target.com')

# Passive enumeration (Certificate Transparency, DNS records)
enum.enumerate_passive()

# Active enumeration with wordlist
enum.enumerate_active(wordlist='subdomains-top1000.txt')

# Permutation-based discovery
enum.enumerate_permutations(base_words=['dev', 'staging', 'api'])

# Verify discovered subdomains
enum.verify_subdomains()

# Export results
print(enum.to_json())
print(enum.to_csv())

# Generate statistics
print(f"Total discovered: {len(enum.subdomains)}")
print(f"Alive hosts: {len(enum.alive_hosts)}")
```

### Email Intelligence

Gather email-related intelligence.

**Example**:
```python
from recon_utils import EmailIntel

email_intel = EmailIntel('target.com')

# Discover email format
email_intel.discover_format()
print(f"Email format: {email_intel.email_format}")
# Output: Email format: {first}.{last}@target.com

# Find exposed emails
email_intel.search_exposed_emails()

# Verify email addresses
email_intel.verify_emails(['john.doe@target.com', 'jane.smith@target.com'])

# Check for breaches (haveibeenpwned-style)
email_intel.check_breaches()

# Generate target list
print(email_intel.generate_target_list())
```

### Technology Fingerprinting

Identify technologies used by target.

**Example**:
```python
from recon_utils import TechFingerprint

tech = TechFingerprint('https://target.com')

# HTTP header analysis
tech.analyze_headers()
print(f"Server: {tech.server}")
print(f"Powered By: {tech.powered_by}")

# Web technology detection
tech.detect_web_technologies()
print(f"CMS: {tech.cms}")
print(f"Frameworks: {tech.frameworks}")
print(f"JavaScript Libraries: {tech.js_libraries}")

# SSL/TLS analysis
tech.analyze_ssl()
print(f"SSL Version: {tech.ssl_version}")
print(f"Certificate: {tech.certificate}")

# WAF detection
tech.detect_waf()
print(f"WAF Detected: {tech.waf}")

# Generate fingerprint report
print(tech.generate_report())
```

### Attack Surface Mapping

Visualize and document the target's attack surface.

**Example**:
```python
from recon_utils import AttackSurfaceMapper

mapper = AttackSurfaceMapper('Target Corporation')

# Add assets
mapper.add_domain('target.com', notes='Primary domain')
mapper.add_domain('api.target.com', notes='API endpoint')
mapper.add_ip_range('192.168.1.0/24', notes='External network')
mapper.add_ip('10.0.0.50', notes='VPN gateway')
mapper.add_service('https://target.com:443', 'Web application')
mapper.add_service('ssh://10.0.0.50:22', 'SSH access')

# Add personnel (for social engineering scope)
mapper.add_person('John Doe', 'CTO', 'john.doe@target.com')
mapper.add_person('Jane Smith', 'IT Admin', 'jane.smith@target.com')

# Add external services
mapper.add_external_service('GitHub', 'https://github.com/targetcorp')
mapper.add_external_service('AWS', 'target-corp-bucket')

# Generate attack surface map
print(mapper.generate_map())

# Export for tools
mapper.export_targets('targets.txt')
mapper.export_scope_json('scope.json')
```

### OSINT Framework Integration

Structured OSINT collection.

**Example**:
```python
from recon_utils import OSINTCollector

osint = OSINTCollector('Target Corp')

# Company information
osint.gather_company_info()
print(f"Industry: {osint.company_info['industry']}")
print(f"Employees: {osint.company_info['employee_count']}")

# Social media presence
osint.discover_social_media()
print(f"LinkedIn: {osint.social_media['linkedin']}")
print(f"Twitter: {osint.social_media['twitter']}")

# Job postings (reveal technology stack)
osint.analyze_job_postings()
print(f"Technologies mentioned: {osint.tech_from_jobs}")

# News and press releases
osint.gather_news()

# Data leaks and breaches
osint.check_data_leaks()

# Generate OSINT report
print(osint.generate_report())
```

## Configuration

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `RECON_TIMEOUT` | Request timeout in seconds | No | `10` |
| `RECON_USER_AGENT` | Custom User-Agent string | No | Standard browser UA |
| `RECON_PROXY` | Proxy URL for requests | No | None |
| `RECON_OUTPUT_DIR` | Output directory | No | `./recon_output` |

### Options

| Option | Type | Description |
|--------|------|-------------|
| `passive_only` | bool | Only perform passive reconnaissance |
| `verify_ssl` | bool | Verify SSL certificates |
| `rate_limit` | int | Requests per second limit |

## Examples

### Example 1: Full Domain Reconnaissance

**Scenario**: Complete reconnaissance of a target domain

**Input**:
```python
recon = PassiveRecon('example.com')
recon.full_scan()
```

**Output**:
```
# Reconnaissance Report: example.com

## DNS Records
- A: 93.184.216.34
- MX: mail.example.com
- NS: ns1.example.com, ns2.example.com
- TXT: v=spf1 include:_spf.example.com ~all

## Subdomains Discovered
- www.example.com (93.184.216.34)
- mail.example.com (93.184.216.35)
- api.example.com (93.184.216.36)

## Technologies
- Server: nginx/1.18.0
- CMS: WordPress 6.0
- WAF: Cloudflare

## Email Addresses
- admin@example.com
- support@example.com
```

### Example 2: Targeted Subdomain Discovery

**Scenario**: Discover all subdomains for bug bounty

**Input**:
```python
enum = SubdomainEnumerator('target.com')
enum.enumerate_passive()
enum.enumerate_active()
enum.verify_subdomains()
```

**Output**:
```
Discovered: 47 subdomains
Alive: 32 hosts

High-value targets:
- admin.target.com (401 - Authentication)
- api-staging.target.com (200 - Exposed API)
- jenkins.target.com (403 - CI/CD)
```

## Limitations

- **Rate Limiting**: Many APIs and services have rate limits
- **Passive Accuracy**: Passive sources may have stale data
- **Legal Constraints**: Active recon requires authorization
- **Geoblocking**: Some sources may block certain regions

## Troubleshooting

### DNS Resolution Issues

**Problem**: DNS queries timing out

**Solution**: Use alternative DNS resolvers:
```python
domain = DomainIntel('target.com', dns_servers=['8.8.8.8', '1.1.1.1'])
```

### Rate Limiting

**Problem**: Getting blocked by rate limits

**Solution**: Adjust rate limiting:
```python
recon = PassiveRecon('target.com', rate_limit=1)  # 1 request per second
```

## Related Skills

- [network-scanning](../network-scanning/): Port and service scanning
- [web-app-testing](../web-app-testing/): Web application testing
- [social-engineering](../social-engineering/): Social engineering techniques
- [pentest-reporting](../pentest-reporting/): Documentation and reporting

## References

- [Detailed API Reference](references/REFERENCE.md)
- [OSINT Framework](https://osintframework.com/)
- [OWASP Testing Guide - Information Gathering](https://owasp.org/www-project-web-security-testing-guide/)
