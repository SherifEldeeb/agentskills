---
name: pentest-reporting
description: |
  Penetration test documentation and reporting. Generate executive summaries,
  technical findings, and remediation guidance for security assessments.
  Use for documenting penetration test results.
license: Apache-2.0
compatibility: |
  - Python 3.9+
  - Optional: reportlab, python-docx
metadata:
  author: SherifEldeeb
  version: "1.0.0"
  category: pentesting
---

# Pentest Reporting Skill

Professional penetration testing documentation and report generation.

## Capabilities

- **Executive Summary**: High-level findings for leadership
- **Technical Findings**: Detailed vulnerability documentation
- **Remediation Guidance**: Fix recommendations and priorities
- **Risk Assessment**: CVSS scoring, risk ratings
- **Evidence Management**: Screenshot and artifact organization
- **Multiple Formats**: PDF, DOCX, HTML, Markdown
- **Templates**: Customizable report templates

## Quick Start

```python
from report_utils import PentestReport, Finding, ReportGenerator

# Create report
report = PentestReport('Acme Corp Penetration Test')
report.set_client('Acme Corporation')
report.set_assessment_type('Internal Network')

# Add findings
finding = Finding(
    title='SQL Injection in Login Form',
    severity='Critical',
    cvss=9.8
)
report.add_finding(finding)

# Generate report
generator = ReportGenerator(report)
generator.generate_pdf('report.pdf')
```

## Usage

### Report Creation

Create and structure penetration test reports.

**Example**:
```python
from report_utils import PentestReport

report = PentestReport('Q1 2024 Security Assessment')

# Set metadata
report.set_client('Acme Corporation')
report.set_assessment_type('External Network Penetration Test')
report.set_dates('2024-01-15', '2024-01-30')
report.set_scope([
    '192.168.1.0/24',
    '*.acme.com',
    'Web applications'
])

# Set team
report.add_team_member('John Doe', 'Lead Tester')
report.add_team_member('Jane Smith', 'Senior Tester')

# Executive summary
report.set_executive_summary('''
Acme Corporation engaged our team to conduct an external network
penetration test. During the assessment, we identified 15 vulnerabilities,
including 3 critical findings that could allow an attacker to gain
full control of the internal network.

Key findings include:
- SQL injection vulnerability allowing database access
- Weak authentication on VPN gateway
- Exposed administrative interfaces
''')

# Methodology
report.set_methodology('''
The assessment followed industry-standard methodology including:
1. Reconnaissance and information gathering
2. Vulnerability scanning and analysis
3. Manual testing and exploitation
4. Post-exploitation and privilege escalation
5. Documentation and reporting
''')
```

### Finding Documentation

Document individual security findings.

**Example**:
```python
from report_utils import Finding

finding = Finding(
    title='SQL Injection in Login Form',
    severity='Critical'
)

# Set details
finding.set_cvss(9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H')
finding.set_cwe('CWE-89')

# Affected assets
finding.add_affected_asset('https://app.acme.com/login')
finding.add_affected_asset('https://api.acme.com/auth')

# Description
finding.set_description('''
A SQL injection vulnerability was identified in the login form at
/login. The 'username' parameter is vulnerable to error-based and
time-based blind SQL injection attacks.

This vulnerability allows an unauthenticated attacker to:
- Bypass authentication
- Extract sensitive data from the database
- Potentially execute commands on the database server
''')

# Steps to reproduce
finding.add_step('Navigate to https://app.acme.com/login')
finding.add_step("Enter payload: admin' OR '1'='1'-- in username field")
finding.add_step('Submit the form')
finding.add_step('Observe successful authentication bypass')

# Evidence
finding.add_evidence('screenshots/sqli_login.png', 'Login bypass screenshot')
finding.add_evidence('burp/sqli_request.xml', 'Burp request/response')

# Impact
finding.set_impact('''
An attacker exploiting this vulnerability could:
- Gain unauthorized access to user accounts
- Extract sensitive customer data
- Modify or delete database records
- Potentially compromise the underlying server
''')

# Remediation
finding.set_remediation('''
1. Use parameterized queries/prepared statements
2. Implement input validation and sanitization
3. Apply principle of least privilege to database accounts
4. Enable web application firewall rules

Example fix (Python):
```python
# Vulnerable
query = f"SELECT * FROM users WHERE username = '{username}'"

# Fixed
cursor.execute("SELECT * FROM users WHERE username = %s", (username,))
```
''')

# References
finding.add_reference('https://owasp.org/www-community/attacks/SQL_Injection')
finding.add_reference('CWE-89: SQL Injection')

# Add to report
report.add_finding(finding)
```

### Risk Assessment

Calculate and present risk ratings.

**Example**:
```python
from report_utils import RiskAssessment

risk = RiskAssessment()

# Calculate overall risk
risk.add_finding('Critical', 3)
risk.add_finding('High', 5)
risk.add_finding('Medium', 7)
risk.add_finding('Low', 10)

# Get summary
summary = risk.get_summary()
print(f"Overall risk: {summary['overall_risk']}")
print(f"Critical: {summary['critical']}")
print(f"High: {summary['high']}")

# Get recommendations priority
priority = risk.get_priority_list()
for item in priority:
    print(f"{item['priority']}: {item['finding']}")

# Risk matrix
matrix = risk.generate_risk_matrix()

# Trend analysis (if historical data)
trend = risk.compare_to_previous('previous_report.json')
```

### Report Generation

Generate reports in various formats.

**Example**:
```python
from report_utils import ReportGenerator

generator = ReportGenerator(report)

# Configure template
generator.set_template('professional')
generator.set_logo('acme_logo.png')
generator.set_colors(primary='#1a1a2e', accent='#4a4e69')

# Generate PDF
generator.generate_pdf('report.pdf')

# Generate Word document
generator.generate_docx('report.docx')

# Generate HTML
generator.generate_html('report.html')

# Generate Markdown
generator.generate_markdown('report.md')

# Generate executive brief (1-2 pages)
generator.generate_executive_brief('executive_brief.pdf')

# Generate technical appendix
generator.generate_technical_appendix('appendix.pdf')

# Generate remediation tracker
generator.generate_remediation_tracker('remediation.xlsx')
```

### Evidence Management

Organize and manage evidence.

**Example**:
```python
from report_utils import EvidenceManager

evidence = EvidenceManager('assessment_2024Q1')

# Add screenshots
evidence.add_screenshot(
    'sqli_login.png',
    finding='SQL Injection',
    description='Successful authentication bypass'
)

# Add request/response
evidence.add_request_response(
    'sqli_burp.xml',
    finding='SQL Injection',
    description='Burp Suite capture'
)

# Add command output
evidence.add_command_output(
    command='sqlmap -u "http://..." --dbs',
    output='[databases listed]',
    finding='SQL Injection'
)

# Organize by finding
evidence.organize_by_finding()

# Create evidence package
evidence.create_package('evidence.zip')

# Generate evidence index
evidence.generate_index('evidence_index.md')
```

## Configuration

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `REPORT_TEMPLATE_DIR` | Template directory | No | `./templates` |
| `REPORT_OUTPUT_DIR` | Output directory | No | `./reports` |

### Template Options

| Option | Type | Description |
|--------|------|-------------|
| `include_executive` | bool | Include executive summary |
| `include_methodology` | bool | Include methodology section |
| `include_appendix` | bool | Include technical appendix |

## Examples

### Example 1: Complete Report

**Scenario**: Full penetration test report

```python
# Create report
report = PentestReport('External Penetration Test')
report.set_client('Acme Corp')
report.set_dates('2024-01-15', '2024-01-30')

# Add 15 findings
for finding_data in findings_list:
    finding = Finding(**finding_data)
    report.add_finding(finding)

# Generate
generator = ReportGenerator(report)
generator.generate_pdf('final_report.pdf')
```

**Output**: Professional PDF report with executive summary, findings, and remediation guidance.

## Limitations

- **Template Customization**: Limited without template editing
- **Complex Layouts**: Some complex layouts require manual adjustment
- **Image Quality**: Depends on source image quality

## Related Skills

- All pentesting skills (sources for findings)
- [docx](../../baseline/docx/): Word document support
- [pdf](../../baseline/pdf/): PDF generation

## References

- [PTES Reporting](http://www.pentest-standard.org/index.php/Reporting)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
