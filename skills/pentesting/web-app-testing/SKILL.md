---
name: web-app-testing
description: |
  Web application security testing following OWASP methodology. Test for common
  vulnerabilities including injection, XSS, authentication flaws, and more.
  Use for web application penetration testing and security assessments.
license: Apache-2.0
compatibility: |
  - Python 3.9+
  - Optional: requests, beautifulsoup4, selenium
metadata:
  author: SherifEldeeb
  version: "1.0.0"
  category: pentesting
---

# Web Application Testing Skill

Comprehensive web application security testing capabilities following OWASP Testing Guide methodology.

## Capabilities

- **Injection Testing**: SQL, NoSQL, LDAP, Command injection
- **XSS Testing**: Reflected, Stored, DOM-based XSS
- **Authentication Testing**: Brute force, session management, password policy
- **Authorization Testing**: IDOR, privilege escalation, access control
- **Input Validation**: Parameter tampering, file upload, format strings
- **Business Logic**: Logic flaws, workflow bypass, race conditions
- **Client-Side Testing**: JavaScript analysis, DOM manipulation
- **API Testing**: REST/GraphQL security testing

## Quick Start

```python
from webapp_utils import WebAppScanner, VulnerabilityTester, AuthTester

# Initialize scanner
scanner = WebAppScanner('https://target.com')
scanner.crawl()
scanner.analyze()

# Test for vulnerabilities
tester = VulnerabilityTester('https://target.com')
tester.test_sql_injection('/search?q=test')
tester.test_xss('/comment')

# Authentication testing
auth = AuthTester('https://target.com/login')
auth.test_brute_force()
auth.test_session_management()
```

## Usage

### Web Application Crawling

Map application structure and endpoints.

**Example**:
```python
from webapp_utils import WebAppScanner

scanner = WebAppScanner('https://target.com')

# Crawl the application
scanner.crawl(depth=3, max_pages=100)

# Get discovered endpoints
endpoints = scanner.get_endpoints()
for endpoint in endpoints:
    print(f"{endpoint['method']} {endpoint['url']}")
    print(f"  Parameters: {endpoint['params']}")

# Get forms
forms = scanner.get_forms()
for form in forms:
    print(f"Form: {form['action']}")
    print(f"  Fields: {form['fields']}")

# Get JavaScript files
scripts = scanner.get_scripts()

# Analyze application
analysis = scanner.analyze()
print(f"Technologies: {analysis['technologies']}")
print(f"Entry points: {analysis['entry_points']}")
```

### SQL Injection Testing

Test for SQL injection vulnerabilities.

**Example**:
```python
from webapp_utils import SQLInjectionTester

sqli = SQLInjectionTester('https://target.com')

# Test parameter for SQL injection
result = sqli.test_parameter('/search', 'q', 'GET')
print(f"Vulnerable: {result['vulnerable']}")
print(f"Type: {result['injection_type']}")
print(f"Payload: {result['payload']}")

# Boolean-based blind SQLi
blind = sqli.test_blind_boolean('/user', 'id')

# Time-based blind SQLi
time_based = sqli.test_blind_time('/user', 'id')

# Error-based SQLi
error_based = sqli.test_error_based('/search', 'q')

# UNION-based SQLi
union = sqli.test_union_based('/products', 'category')

# Generate payloads
payloads = sqli.generate_payloads(dbms='mysql')

# Test all parameters on page
all_results = sqli.test_all_params('/search?q=test&page=1&sort=name')
```

### Cross-Site Scripting (XSS) Testing

Test for XSS vulnerabilities.

**Example**:
```python
from webapp_utils import XSSTester

xss = XSSTester('https://target.com')

# Test for reflected XSS
reflected = xss.test_reflected('/search', 'q')
print(f"Vulnerable: {reflected['vulnerable']}")
print(f"Context: {reflected['context']}")
print(f"Payload: {reflected['payload']}")

# Test for stored XSS
stored = xss.test_stored(
    submit_url='/comment',
    view_url='/post/123',
    param='message'
)

# Test for DOM XSS
dom = xss.test_dom('/page#param=value')

# Test with encoding bypass
bypass = xss.test_with_bypass('/search', 'q', bypass_type='html_entities')

# Test all input fields
all_results = xss.test_all_inputs('/contact')

# Generate context-aware payloads
payloads = xss.generate_payloads(context='html_attribute')
```

### Authentication Testing

Test authentication mechanisms.

**Example**:
```python
from webapp_utils import AuthTester

auth = AuthTester('https://target.com')

# Configure login form
auth.set_login_form(
    url='/login',
    username_field='email',
    password_field='password',
    success_indicator='Welcome'
)

# Test for username enumeration
enum = auth.test_username_enumeration(['admin', 'user', 'test'])
print(f"Enumerable: {enum['enumerable']}")
print(f"Valid users: {enum['valid_users']}")

# Test password policy
policy = auth.test_password_policy()
print(f"Min length: {policy['min_length']}")
print(f"Complexity: {policy['complexity']}")

# Test account lockout
lockout = auth.test_account_lockout()
print(f"Lockout after: {lockout['attempts']} attempts")
print(f"Lockout duration: {lockout['duration']}")

# Test session management
session = auth.test_session_management()
print(f"Session fixation: {session['fixation_vulnerable']}")
print(f"Session timeout: {session['timeout']}")

# Test remember me functionality
remember = auth.test_remember_me()

# Test password reset
reset = auth.test_password_reset()
```

### Authorization Testing

Test access control mechanisms.

**Example**:
```python
from webapp_utils import AuthzTester

authz = AuthzTester('https://target.com')

# Set up user contexts
authz.add_user('admin', {'cookie': 'session=admin123'})
authz.add_user('user', {'cookie': 'session=user456'})
authz.add_user('guest', {})

# Test horizontal privilege escalation (IDOR)
idor = authz.test_idor('/api/users/{id}/profile', 'user')
print(f"IDOR vulnerable: {idor['vulnerable']}")
print(f"Accessible IDs: {idor['accessible_ids']}")

# Test vertical privilege escalation
vertical = authz.test_vertical_escalation('/admin/dashboard', 'user')

# Test insecure direct object references
refs = authz.test_object_references([
    '/api/documents/123',
    '/api/orders/456',
    '/api/users/789'
])

# Test function-level access control
functions = authz.test_function_access([
    '/api/admin/users',
    '/api/admin/settings',
    '/api/admin/logs'
])

# Test forced browsing
forced = authz.test_forced_browsing([
    '/admin/',
    '/backup/',
    '/config/',
    '/.git/'
])
```

### Input Validation Testing

Test input validation and sanitization.

**Example**:
```python
from webapp_utils import InputValidationTester

validator = InputValidationTester('https://target.com')

# Test file upload
upload = validator.test_file_upload('/upload', 'file')
print(f"Allowed types: {upload['allowed_types']}")
print(f"Bypass possible: {upload['bypass_possible']}")
print(f"RCE risk: {upload['rce_risk']}")

# Test with malicious files
malicious = validator.test_malicious_upload('/upload', 'file')

# Test parameter tampering
tampering = validator.test_param_tampering('/checkout', {
    'price': '100',
    'quantity': '1',
    'discount': '0'
})

# Test HTTP parameter pollution
hpp = validator.test_hpp('/search?q=test')

# Test header injection
header = validator.test_header_injection('/redirect?url=')

# Test path traversal
traversal = validator.test_path_traversal('/download?file=report.pdf')

# Test server-side request forgery (SSRF)
ssrf = validator.test_ssrf('/fetch?url=')
```

### Business Logic Testing

Test for business logic flaws.

**Example**:
```python
from webapp_utils import BusinessLogicTester

logic = BusinessLogicTester('https://target.com')

# Test workflow bypass
bypass = logic.test_workflow_bypass([
    '/cart',
    '/checkout',
    '/payment',
    '/confirmation'
])

# Test race conditions
race = logic.test_race_condition(
    url='/api/redeem',
    method='POST',
    data={'code': 'DISCOUNT50'},
    threads=10
)

# Test numeric limits
limits = logic.test_numeric_limits('/api/transfer', {
    'amount': [0, -1, 999999999, 0.001]
})

# Test time-based logic
time = logic.test_time_based('/api/coupon', 'valid_until')

# Test multi-step process
multistep = logic.test_multistep_bypass('/checkout/process')
```

### Security Headers Analysis

Analyze security headers.

**Example**:
```python
from webapp_utils import HeaderAnalyzer

headers = HeaderAnalyzer('https://target.com')

# Analyze all security headers
analysis = headers.analyze()

print(f"Content-Security-Policy: {analysis['csp']}")
print(f"X-Frame-Options: {analysis['xfo']}")
print(f"X-XSS-Protection: {analysis['xss_protection']}")
print(f"HSTS: {analysis['hsts']}")
print(f"X-Content-Type-Options: {analysis['xcto']}")

# Get recommendations
recommendations = headers.get_recommendations()
for rec in recommendations:
    print(f"- {rec['header']}: {rec['recommendation']}")

# Check for missing headers
missing = headers.get_missing_headers()
```

## Configuration

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `WEBAPP_TIMEOUT` | Request timeout in seconds | No | `30` |
| `WEBAPP_USER_AGENT` | Custom User-Agent | No | Standard browser |
| `WEBAPP_PROXY` | Proxy URL | No | None |
| `WEBAPP_THREADS` | Concurrent threads | No | `5` |

### Options

| Option | Type | Description |
|--------|------|-------------|
| `verify_ssl` | bool | Verify SSL certificates |
| `follow_redirects` | bool | Follow HTTP redirects |
| `cookie_jar` | str | Path to cookie jar file |

## Examples

### Example 1: Full OWASP Assessment

**Scenario**: Complete web application security assessment

**Input**:
```python
scanner = WebAppScanner('https://target.com')
scanner.run_owasp_assessment()
```

**Output**:
```
# OWASP Top 10 Assessment Report

## A01:2021 - Broken Access Control
- IDOR vulnerability in /api/users/{id}
- Missing authorization on /admin/reports

## A02:2021 - Cryptographic Failures
- Sensitive data exposed in /api/debug

## A03:2021 - Injection
- SQL injection in /search?q=
- Command injection in /ping?host=

## A07:2021 - Cross-Site Scripting
- Reflected XSS in /search
- Stored XSS in /comments
```

## Limitations

- **False Positives**: Automated testing may produce false positives
- **Business Logic**: Complex logic flaws require manual testing
- **WAF Bypass**: Limited WAF evasion capabilities
- **Authenticated Testing**: Requires valid session tokens

## Troubleshooting

### Connection Refused

**Problem**: Target not responding

**Solution**: Check target URL and network connectivity:
```python
scanner = WebAppScanner('https://target.com', verify_ssl=False)
```

### Rate Limiting

**Problem**: Getting rate limited

**Solution**: Add delays:
```python
tester = VulnerabilityTester('https://target.com', delay=2)
```

## Related Skills

- [api-security-testing](../api-security-testing/): API-specific testing
- [reconnaissance](../reconnaissance/): Information gathering
- [exploitation](../exploitation/): Exploit vulnerabilities
- [pentest-reporting](../pentest-reporting/): Document findings

## References

- [Detailed API Reference](references/REFERENCE.md)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
